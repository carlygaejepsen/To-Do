<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üçì Cute Todo List ‚ú®</title>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @keyframes bounce {
            0%, 20%, 53%, 80%, 100% {
                animation-timing-function: cubic-bezier(0.215, 0.610, 0.355, 1.000);
                transform: translate3d(0,0,0);
            }
            40%, 43% {
                animation-timing-function: cubic-bezier(0.755, 0.050, 0.855, 0.060);
                transform: translate3d(0, -30px, 0);
            }
            70% {
                animation-timing-function: cubic-bezier(0.755, 0.050, 0.855, 0.060);
                transform: translate3d(0, -15px, 0);
            }
            90% {
                transform: translate3d(0,-4px,0);
            }
        }
        .animate-bounce {
            animation: bounce 2s infinite;
        }
        .hover\:scale-\[1\.02\]:hover {
            transform: scale(1.02);
        }
        .bg-white\/80 {
            background-color: rgba(255, 255, 255, 0.8);
        }
        .bg-white\/70 {
            background-color: rgba(255, 255, 255, 0.7);
        }
        .backdrop-blur-sm {
            backdrop-filter: blur(4px);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, createElement: h } = React;

        // Simple icon components
        const Plus = () => h('svg', { width: 20, height: 20, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 }, 
            h('path', { d: 'M12 5v14M5 12h14' })
        );
        
        const X = ({ size = 14 }) => h('svg', { width: size, height: size, viewBox: '0 0 24 24', fill: 'none', stroke: 'currentColor', strokeWidth: 2 }, 
            h('path', { d: 'M18 6 6 18M6 6l12 12' })
        );

        function TodoList() {
            const [tasks, setTasks] = useState([]);
            const [newTask, setNewTask] = useState("");
            const [filter, setFilter] = useState("all");
            const [showBulkUpload, setShowBulkUpload] = useState(false);
            const [bulkTasks, setBulkTasks] = useState("");
            const [draggedItem, setDraggedItem] = useState(null);
            const [expandedTasks, setExpandedTasks] = useState(new Set());
            const [newSubtask, setNewSubtask] = useState({});
            const [showBulkSubtask, setShowBulkSubtask] = useState({});
            const [bulkSubtasks, setBulkSubtasks] = useState({});

            // Load from localStorage on mount
            useEffect(() => {
                const savedTasks = localStorage.getItem("myTodoAppTasks2024");
                const savedExpanded = localStorage.getItem("myTodoAppExpanded2024");

                if (savedTasks) {
                    try {
                        const parsed = JSON.parse(savedTasks);
                        setTasks(parsed);
                    } catch (e) {
                        console.log("Could not load saved tasks");
                        setTasks([
                            {
                                id: 1,
                                text: "Welcome to your to-do list! üå∏",
                                completed: false,
                                urgent: false,
                                easy: false,
                                project: false,
                                subtasks: [],
                            },
                            {
                                id: 2,
                                text: "Click the strawberry to mark tasks complete! üçì",
                                completed: false,
                                urgent: false,
                                easy: false,
                                project: false,
                                subtasks: [],
                            },
                        ]);
                    }
                } else {
                    setTasks([
                        {
                            id: 1,
                            text: "Welcome to your to-do list! üå∏",
                            completed: false,
                            urgent: false,
                            easy: false,
                            project: false,
                            subtasks: [],
                        },
                        {
                            id: 2,
                            text: "Click the strawberry to mark tasks complete! üçì",
                            completed: false,
                            urgent: false,
                            easy: false,
                            project: false,
                            subtasks: [],
                        },
                    ]);
                }

                if (savedExpanded) {
                    try {
                        const parsed = JSON.parse(savedExpanded);
                        setExpandedTasks(new Set(parsed));
                    } catch (e) {
                        console.log("Could not load expanded state");
                    }
                }
            }, []);

            // Save to localStorage whenever tasks change
            useEffect(() => {
                localStorage.setItem("myTodoAppTasks2024", JSON.stringify(tasks));
            }, [tasks]);

            // Save expanded state
            useEffect(() => {
                localStorage.setItem(
                    "myTodoAppExpanded2024",
                    JSON.stringify([...expandedTasks])
                );
            }, [expandedTasks]);

            const addTask = () => {
                if (newTask.trim() !== "") {
                    setTasks([
                        {
                            id: Date.now(),
                            text: newTask.trim(),
                            completed: false,
                            urgent: false,
                            easy: false,
                            project: false,
                            subtasks: [],
                        },
                        ...tasks
                    ]);
                    setNewTask("");
                }
            };

            const toggleTask = (id) => {
                setTasks(
                    tasks.map((task) =>
                        task.id === id ? { ...task, completed: !task.completed } : task
                    )
                );
            };

            const toggleSubtask = (taskId, subtaskId) => {
                setTasks(
                    tasks.map((task) => {
                        if (task.id === taskId) {
                            const updatedSubtasks = task.subtasks.map((subtask) =>
                                subtask.id === subtaskId
                                    ? { ...subtask, completed: !subtask.completed }
                                    : subtask
                            );
                            const allSubtasksComplete =
                                updatedSubtasks.length > 0 &&
                                updatedSubtasks.every((sub) => sub.completed);
                            return {
                                ...task,
                                subtasks: updatedSubtasks,
                                completed: allSubtasksComplete ? true : task.completed,
                            };
                        }
                        return task;
                    })
                );
            };

            const addSubtask = (taskId) => {
                const subtaskText = newSubtask[taskId];
                if (subtaskText && subtaskText.trim() !== "") {
                    setTasks(
                        tasks.map((task) => {
                            if (task.id === taskId) {
                                return {
                                    ...task,
                                    subtasks: [
                                        ...task.subtasks,
                                        {
                                            id: Date.now() + Math.random(),
                                            text: subtaskText.trim(),
                                            completed: false,
                                        },
                                    ],
                                };
                            }
                            return task;
                        })
                    );
                    setNewSubtask({ ...newSubtask, [taskId]: "" });
                }
            };

            const addBulkSubtasks = (taskId) => {
                const bulkText = bulkSubtasks[taskId];
                if (bulkText && bulkText.trim() !== "") {
                    const newSubtaskItems = bulkText
                        .split("\n")
                        .map((line) => line.trim())
                        .filter((line) => line !== "")
                        .map((text) => ({
                            id: Date.now() + Math.random(),
                            text,
                            completed: false,
                        }));

                    setTasks(
                        tasks.map((task) => {
                            if (task.id === taskId) {
                                return {
                                    ...task,
                                    subtasks: [...task.subtasks, ...newSubtaskItems],
                                };
                            }
                            return task;
                        })
                    );
                    setBulkSubtasks({ ...bulkSubtasks, [taskId]: "" });
                    setShowBulkSubtask({ ...showBulkSubtask, [taskId]: false });
                }
            };

            const deleteSubtask = (taskId, subtaskId) => {
                setTasks(
                    tasks.map((task) => {
                        if (task.id === taskId) {
                            return {
                                ...task,
                                subtasks: task.subtasks.filter(
                                    (subtask) => subtask.id !== subtaskId
                                ),
                            };
                        }
                        return task;
                    })
                );
            };

            const toggleExpanded = (taskId) => {
                const newExpanded = new Set(expandedTasks);
                if (newExpanded.has(taskId)) {
                    newExpanded.delete(taskId);
                } else {
                    newExpanded.add(taskId);
                }
                setExpandedTasks(newExpanded);
            };

            const toggleProject = (id) => {
                setTasks(
                    tasks.map((task) =>
                        task.id === id
                            ? {
                                ...task,
                                project: !task.project,
                                urgent: task.project ? task.urgent : false,
                                easy: task.project ? task.easy : false,
                            }
                            : task
                    )
                );
            };

            const toggleUrgent = (id) => {
                setTasks(
                    tasks.map((task) =>
                        task.id === id
                            ? {
                                ...task,
                                urgent: !task.urgent,
                                easy: task.urgent ? task.easy : false,
                                project: task.urgent ? task.project : false,
                            }
                            : task
                    )
                );
            };

            const toggleEasy = (id) => {
                setTasks(
                    tasks.map((task) =>
                        task.id === id
                            ? {
                                ...task,
                                easy: !task.easy,
                                urgent: task.easy ? task.urgent : false,
                                project: task.easy ? task.project : false,
                            }
                            : task
                    )
                );
            };

            const deleteTask = (id) => {
                setTasks(tasks.filter((task) => task.id !== id));
            };

            const clearCompleted = () => {
                setTasks(tasks.filter((task) => !task.completed));
            };

            const addBulkTasks = () => {
                if (bulkTasks.trim() !== "") {
                    const newTasks = bulkTasks
                        .split("\n")
                        .map((line) => line.trim())
                        .filter((line) => line !== "")
                        .map((text) => ({
                            id: Date.now() + Math.random(),
                            text,
                            completed: false,
                            urgent: false,
                            easy: false,
                            project: false,
                            subtasks: [],
                        }));

                    setTasks([...newTasks, ...tasks]);
                    setBulkTasks("");
                    setShowBulkUpload(false);
                }
            };

            const exportTasks = () => {
                let exportText = "";
                tasks.forEach((task) => {
                    let taskLine = task.text;
                    if (task.urgent) taskLine += " [PRIORITY]";
                    if (task.easy) taskLine += " [QUICK]";
                    if (task.project) taskLine += " [PROJECT]";
                    if (task.completed) taskLine += " [DONE]";
                    exportText += taskLine + "\n";

                    task.subtasks.forEach((subtask) => {
                        let subtaskLine = "  " + subtask.text;
                        if (subtask.completed) subtaskLine += " [DONE]";
                        exportText += subtaskLine + "\n";
                    });
                    exportText += "\n";
                });

                navigator.clipboard
                    .writeText(exportText)
                    .then(() => {
                        alert("‚úÖ All tasks copied to clipboard! Paste this somewhere safe.");
                    })
                    .catch(() => {
                        const textarea = document.createElement("textarea");
                        textarea.value = exportText;
                        document.body.appendChild(textarea);
                        textarea.select();
                        document.execCommand("copy");
                        document.body.removeChild(textarea);
                        alert("‚úÖ All tasks copied to clipboard! Paste this somewhere safe.");
                    });
            };

            const exportAsJSON = () => {
                const exportData = {
                    tasks: tasks,
                    exportDate: new Date().toISOString(),
                    version: "1.0",
                };

                const dataStr = JSON.stringify(exportData, null, 2);
                const dataBlob = new Blob([dataStr], { type: "application/json" });
                const url = URL.createObjectURL(dataBlob);

                const link = document.createElement("a");
                link.href = url;
                link.download = `cute-todo-list-${
                    new Date().toISOString().split("T")[0]
                }.json`;
                document.body.appendChild(link);
                link.click();
                document.body.removeChild(link);
                URL.revokeObjectURL(url);
            };

            const importFromJSON = (event) => {
                const file = event.target.files[0];
                if (!file) return;

                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const importData = JSON.parse(e.target.result);

                        if (importData.tasks && Array.isArray(importData.tasks)) {
                            const validTasks = importData.tasks.filter(
                                (task) =>
                                    task.id &&
                                    task.text &&
                                    typeof task.completed === "boolean" &&
                                    typeof task.urgent === "boolean" &&
                                    typeof task.easy === "boolean" &&
                                    typeof task.project === "boolean" &&
                                    Array.isArray(task.subtasks)
                            );

                            if (validTasks.length > 0) {
                                setTasks(validTasks);
                                alert(`‚úÖ Successfully imported ${validTasks.length} tasks!`);
                            } else {
                                alert("‚ùå No valid tasks found in the file.");
                            }
                        } else {
                            alert(
                                "‚ùå Invalid file format. Please select a valid to-do list file."
                            );
                        }
                    } catch (error) {
                        alert(
                            "‚ùå Error reading file. Please make sure it's a valid JSON file."
                        );
                    }
                };

                reader.readAsText(file);
                event.target.value = "";
            };

            const handleDragStart = (e, task) => {
                setDraggedItem(task);
                e.dataTransfer.effectAllowed = "move";
            };

            const handleDragOver = (e) => {
                e.preventDefault();
                e.dataTransfer.dropEffect = "move";
            };

            const handleDragEnter = (e) => {
                e.preventDefault();
            };

            const handleDrop = (e, targetTask) => {
                e.preventDefault();

                if (!draggedItem || draggedItem.id === targetTask.id) {
                    setDraggedItem(null);
                    return;
                }

                const originalDraggedIndex = tasks.findIndex(
                    (task) => task.id === draggedItem.id
                );
                const originalTargetIndex = tasks.findIndex(
                    (task) => task.id === targetTask.id
                );

                const newTasks = [...tasks];
                const [removed] = newTasks.splice(originalDraggedIndex, 1);
                newTasks.splice(originalTargetIndex, 0, removed);

                setTasks(newTasks);
                setDraggedItem(null);
            };

            const filteredTasks = tasks.filter((task) => {
                if (filter === "active") return !task.completed;
                if (filter === "completed") return task.completed;
                if (filter === "urgent") return task.urgent && !task.completed;
                if (filter === "easy") return task.easy && !task.completed;
                if (filter === "project") return task.project && !task.completed;
                return true;
            });

            const activeCount = tasks.filter((task) => !task.completed).length;
            const completedCount = tasks.filter((task) => task.completed).length;
            const urgentCount = tasks.filter(
                (task) => task.urgent && !task.completed
            ).length;
            const easyCount = tasks.filter((task) => task.easy && !task.completed).length;
            const projectCount = tasks.filter((task) => task.project && !task.completed).length;

            const handleKeyPress = (e) => {
                if (e.key === "Enter") {
                    addTask();
                }
            };

            return h('div', {
                className: "min-h-screen p-4",
                style: {
                    background: `linear-gradient(135deg, rgba(253, 242, 248, 0.7), rgba(243, 232, 255, 0.7), rgba(219, 234, 254, 0.7)), url("https://i.imgur.com/lJEnnml.png")`,
                    backgroundSize: "cover",
                    backgroundPosition: "center",
                    backgroundRepeat: "no-repeat",
                    backgroundAttachment: "fixed",
                }
            }, 
                h('div', { className: "max-w-md mx-auto pt-8" },
                    // Floating decorative elements
                    h('div', {
                        className: "absolute top-4 left-4 text-pink-300 animate-bounce",
                        style: { animationDelay: "0s" }
                    }, "üêù"),
                    h('div', {
                        className: "absolute top-8 right-8 text-purple-300 animate-bounce",
                        style: { animationDelay: "1s" }
                    }, "ü¶ã"),
                    h('div', {
                        className: "absolute top-16 left-16 text-yellow-300 animate-bounce",
                        style: { animationDelay: "2s" }
                    }, "ü¶ã"),

                    h('div', { className: "bg-white/80 backdrop-blur-sm rounded-3xl shadow-xl border-4 border-pink-200 p-6 relative overflow-hidden" },
                        // Decorative corner elements
                        h('div', { className: "absolute top-0 left-0 text-pink-400 text-2xl" }, "üåü"),
                        h('div', { className: "absolute top-0 right-0 text-purple-400 text-2xl" }, "üåô"),

                        // Header
                        h('div', { className: "text-center mb-6" },
                            h('h1', { className: "text-3xl font-bold bg-gradient-to-r from-pink-500 via-purple-500 to-blue-500 bg-clip-text text-transparent mb-2" },
                                "‚ú® My To-Do List ‚ú®"
                            ),
                            h('div', { className: "flex justify-center gap-2 text-2xl" },
                                h('span', { className: "animate-pulse" }, "üåª"),
                                h('span', { className: "animate-pulse", style: { animationDelay: "0.5s" } }, "üåø"),
                                h('span', { className: "animate-pulse", style: { animationDelay: "1s" } }, "üå∏")
                            ),
                            h('p', { className: "text-xs text-gray-500 mt-2" }, "üéÅ Auto-saves locally!")
                        ),

                        // Add new task
                        h('div', { className: "bg-gradient-to-r from-pink-100 to-red-100 rounded-2xl p-4 mb-6 border-2 border-pink-200" },
                            h('div', { className: "flex gap-3 items-center mb-3" },
                                h('span', { className: "text-2xl" }, "üçì"),
                                h('input', {
                                    type: "text",
                                    value: newTask,
                                    onChange: (e) => setNewTask(e.target.value),
                                    onKeyPress: handleKeyPress,
                                    placeholder: "Add a new task...",
                                    className: "flex-1 px-4 py-3 bg-white/70 border-2 border-pink-200 rounded-full focus:outline-none focus:ring-4 focus:ring-pink-200 focus:border-pink-400 transition-all text-gray-700"
                                }),
                                h('button', {
                                    onClick: addTask,
                                    className: "px-6 py-3 bg-gradient-to-r from-pink-400 to-red-400 text-white rounded-full hover:from-pink-500 hover:to-red-500 focus:outline-none focus:ring-4 focus:ring-pink-200 transition-all transform hover:scale-105 shadow-lg"
                                }, h(Plus))
                            ),

                            // Bulk upload toggle
                            h('div', { className: "flex justify-center" },
                                h('button', {
                                    onClick: () => setShowBulkUpload(!showBulkUpload),
                                    className: "text-sm text-pink-600 hover:text-pink-800 transition-colors flex items-center gap-2"
                                }, showBulkUpload ? "‚úï Close bulk upload" : "ü™Ñ Add multiple tasks")
                            ),

                            // Bulk upload area
                            showBulkUpload && h('div', { className: "mt-4 space-y-3" },
                                h('textarea', {
                                    value: bulkTasks,
                                    onChange: (e) => setBulkTasks(e.target.value),
                                    placeholder: "Paste your tasks here, one per line:\n\nTask 1\nTask 2\nTask 3",
                                    rows: 6,
                                    className: "w-full px-4 py-3 bg-white/70 border-2 border-pink-200 rounded-xl focus:outline-none focus:ring-4 focus:ring-pink-200 focus:border-pink-400 transition-all text-gray-700 resize-none"
                                }),
                                h('div', { className: "flex gap-2 justify-end" },
                                    h('button', {
                                        onClick: () => {
                                            setBulkTasks("");
                                            setShowBulkUpload(false);
                                        },
                                        className: "px-4 py-2 bg-gray-200 text-gray-700 rounded-full hover:bg-gray-300 transition-colors"
                                    }, "Cancel"),
                                    h('button', {
                                        onClick: addBulkTasks,
                                        className: "px-6 py-2 bg-gradient-to-r from-pink-400 to-red-400 text-white rounded-full hover:from-pink-500 hover:to-red-500 transition-all transform hover:scale-105 shadow-lg flex items-center gap-2"
                                    }, h('span', null, "ü™Ñ"), "Add All Tasks")
                                )
                            )
                        ),

                        // Filter buttons
                        h('div', { className: "flex gap-2 mb-6 justify-center flex-wrap" },
                            h('button', {
                                onClick: () => setFilter("all"),
                                className: `px-4 py-2 rounded-full transition-all transform hover:scale-105 flex flex-col items-center gap-1 ${
                                    filter === "all"
                                        ? "bg-gradient-to-r from-green-200 to-emerald-200 text-green-800 shadow-lg border-2 border-green-300"
                                        : "bg-white/70 text-gray-600 hover:bg-green-100 border-2 border-transparent"
                                }`
                            }, h('span', { className: "text-lg" }, "üå±"), h('span', { className: "text-xs" }, `All (${tasks.length})`)),
                            h('button', {
                                onClick: () => setFilter("urgent"),
                                className: `px-4 py-2 rounded-full transition-all transform hover:scale-105 flex flex-col items-center gap-1 ${
                                    filter === "urgent"
                                        ? "bg-gradient-to-r from-red-200 to-pink-200 text-red-800 shadow-lg border-2 border-red-300"
                                        : "bg-white/70 text-gray-600 hover:bg-red-100 border-2 border-transparent"
                                }`
                            }, h('span', { className: "text-lg" }, "‚≠ê"), h('span', { className: "text-xs" }, `Priority (${urgentCount})`)),
                            h('button', {
                                onClick: () => setFilter("easy"),
                                className: `px-4 py-2 rounded-full transition-all transform hover:scale-105 flex flex-col items-center gap-1 ${
                                    filter === "easy"
                                        ? "bg-gradient-to-r from-blue-200 to-cyan-200 text-blue-800 shadow-lg border-2 border-blue-300"
                                        : "bg-white/70 text-gray-600 hover:bg-blue-100 border-2 border-transparent"
                                }`
                            }, h('span', { className: "text-lg" }, "ü™Ω"), h('span', { className: "text-xs" }, `Quick (${easyCount})`)),
                            h('button', {
                                onClick: () => setFilter("project"),
                                className: `px-4 py-2 rounded-full transition-all transform hover:scale-105 flex flex-col items-center gap-1 ${
                                    filter === "project"
                                        ? "bg-gradient-to-r from-indigo-200 to-violet-200 text-indigo-800 shadow-lg border-2 border-indigo-300"
                                        : "bg-white/70 text-gray-600 hover:bg-indigo-100 border-2 border-transparent"
                                }`
                            }, h('span', { className: "text-lg" }, "üêå"), h('span', { className: "text-xs" }, `Projects (${projectCount})`)),
                            h('button', {
                                onClick: () => setFilter("active"),
                                className: `px-4 py-2 rounded-full transition-all transform hover:scale-105 flex flex-col items-center gap-1 ${
                                    filter === "active"
                                        ? "bg-gradient-to-r from-yellow-200 to-orange-200 text-orange-800 shadow-lg border-2 border-yellow-300"
                                        : "bg-white/70 text-gray-600 hover:bg-yellow-100 border-2 border-transparent"
                                }`
                            }, h('span', { className: "text-lg" }, "ü™¥"), h('span', { className: "text-xs" }, `Active (${activeCount})`)),
                            h('button', {
                                onClick: () => setFilter("completed"),
                                className: `px-4 py-2 rounded-full transition-all transform hover:scale-105 flex flex-col items-center gap-1 ${
                                    filter === "completed"
                                        ? "bg-gradient-to-r from-purple-200 to-pink-200 text-purple-800 shadow-lg border-2 border-purple-300"
                                        : "bg-white/70 text-gray-600 hover:bg-purple-100 border-2 border-transparent"
                                }`
                            }, h('span', { className: "text-lg" }, "üå∏"), h('span', { className: "text-xs" }, `Done (${completedCount})`))
                        ),

                        // Task list
                        h('div', { className: "space-y-3 mb-6" },
                            filteredTasks.length === 0 ? 
                                h('div', { className: "text-center py-8" },
                                    h('div', { className: "text-6xl mb-4" }, "üîÆ"),
                                    h('p', { className: "text-gray-500" },
                                        filter === "active" ? "No active tasks!" :
                                        filter === "completed" ? "No completed tasks yet!" :
                                        filter === "urgent" ? "No priority tasks!" :
                                        filter === "easy" ? "No quick tasks!" :
                                        filter === "project" ? "No projects!" :
                                        "No tasks yet. Add one above!"
                                    )
                                ) :
                                filteredTasks.map((task) => 
                                    h('div', { key: task.id, className: "space-y-0" },
                                        h('div', {
                                            draggable: true,
                                            onDragStart: (e) => handleDragStart(e, task),
                                            onDragOver: handleDragOver,
                                            onDragEnter: handleDragEnter,
                                            onDrop: (e) => handleDrop(e, task),
                                            className: `group p-4 rounded-2xl transition-all transform hover:scale-[1.02] cursor-move relative ${
                                                task.completed
                                                    ? "bg-gradient-to-r from-green-100 to-emerald-100 border-2 border-green-200 shadow-lg"
                                                    : task.urgent
                                                    ? "bg-gradient-to-r from-pink-50 to-red-50 border-2 border-pink-300 hover:from-pink-100 hover:to-red-100 shadow-md hover:shadow-lg"
                                                    : task.easy
                                                    ? "bg-gradient-to-r from-blue-50 to-cyan-50 border-2 border-blue-300 hover:from-blue-100 hover:to-cyan-100 shadow-md hover:shadow-lg"
                                                    : task.project
                                                    ? "bg-gradient-to-r from-indigo-50 to-violet-50 border-2 border-indigo-300 hover:from-indigo-100 hover:to-violet-100 shadow-md hover:shadow-lg"
                                                    : "bg-gradient-to-r from-pink-50 to-purple-50 border-2 border-pink-200 hover:from-pink-100 hover:to-purple-100 shadow-md hover:shadow-lg"
                                            } ${draggedItem?.id === task.id ? "opacity-50" : ""}`
                                        },
                                            // Tag toggle buttons at top (always visible for incomplete tasks)
                                            !task.completed && h('div', { className: "mb-2 flex justify-center gap-2" },
                                                h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        toggleUrgent(task.id);
                                                    },
                                                    className: `w-8 h-8 rounded-full transition-all transform hover:scale-110 flex items-center justify-center ${
                                                        task.urgent
                                                            ? "bg-gradient-to-r from-pink-400 to-red-400 text-white shadow-lg"
                                                            : "bg-gray-100 hover:bg-pink-100 text-gray-400 hover:text-pink-500"
                                                    }`,
                                                    title: task.urgent ? "Remove priority" : "Mark as priority"
                                                }, h('span', { className: "text-sm" }, "‚≠ê")),

                                                h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        toggleEasy(task.id);
                                                    },
                                                    className: `w-8 h-8 rounded-full transition-all transform hover:scale-110 flex items-center justify-center ${
                                                        task.easy
                                                            ? "bg-gradient-to-r from-blue-400 to-cyan-400 text-white shadow-lg"
                                                            : "bg-gray-100 hover:bg-blue-100 text-gray-400 hover:text-blue-500"
                                                    }`,
                                                    title: task.easy ? "Remove quick tag" : "Mark as quick task"
                                                }, h('span', { className: "text-sm" }, "ü™Ω")),

                                                h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        toggleProject(task.id);
                                                    },
                                                    className: `w-8 h-8 rounded-full transition-all transform hover:scale-110 flex items-center justify-center ${
                                                        task.project
                                                            ? "bg-gradient-to-r from-indigo-400 to-violet-400 text-white shadow-lg"
                                                            : "bg-gray-100 hover:bg-indigo-100 text-gray-400 hover:text-indigo-500"
                                                    }`,
                                                    title: task.project ? "Remove project tag" : "Mark as long-term project"
                                                }, h('span', { className: "text-sm" }, "üêå"))
                                            ),

                                            // Main task row
                                            h('div', { className: "flex items-center gap-4 w-full" },
                                                // Drag handle
                                                h('div', { className: "flex-shrink-0 text-gray-400 cursor-move opacity-0 group-hover:opacity-100 transition-opacity" },
                                                    h('span', { className: "text-lg" }, "‚ãÆ‚ãÆ")
                                                ),

                                                h('button', {
                                                    onClick: () => toggleTask(task.id),
                                                    className: `flex-shrink-0 w-8 h-8 rounded-full flex items-center justify-center transition-all transform hover:scale-110 ${
                                                        task.completed
                                                            ? "bg-gradient-to-r from-green-400 to-emerald-400 shadow-lg"
                                                            : "bg-gradient-to-r from-pink-200 to-red-200 hover:from-pink-300 hover:to-red-300 border-2 border-pink-300"
                                                    }`
                                                },
                                                    task.completed ? 
                                                        h('span', { className: "text-white text-sm" }, "‚úì") :
                                                        h('span', { className: "text-lg" }, "üçì")
                                                ),

                                                h('span', {
                                                    className: `flex-1 transition-all ${
                                                        task.completed
                                                            ? "text-green-700 line-through opacity-75"
                                                            : "text-gray-800"
                                                    }`
                                                },
                                                    task.text,
                                                    task.subtasks.length > 0 && h('span', { className: "ml-2 text-xs text-gray-500" },
                                                        `(${task.subtasks.filter((sub) => sub.completed).length}/${task.subtasks.length})`
                                                    )
                                                ),

                                                // Subtask toggle button
                                                task.subtasks.length > 0 && h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        toggleExpanded(task.id);
                                                    },
                                                    className: "flex-shrink-0 w-6 h-6 rounded-full bg-gray-100 hover:bg-gray-200 text-gray-600 transition-all transform hover:scale-110 flex items-center justify-center"
                                                },
                                                    h('span', { className: `text-xs transition-transform ${expandedTasks.has(task.id) ? "rotate-90" : ""}` }, "‚ñ∂")
                                                ),

                                                // Add subtask button
                                                h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        const newExpanded = new Set(expandedTasks);
                                                        newExpanded.add(task.id);
                                                        setExpandedTasks(newExpanded);
                                                    },
                                                    className: "flex-shrink-0 w-7 h-7 rounded-full bg-purple-100 hover:bg-purple-200 text-purple-500 hover:text-purple-600 transition-all transform hover:scale-110 flex items-center justify-center opacity-0 group-hover:opacity-100",
                                                    title: "Add subtask"
                                                }, h(Plus, { size: 12 })),

                                                h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        deleteTask(task.id);
                                                    },
                                                    className: "flex-shrink-0 w-7 h-7 rounded-full bg-red-100 hover:bg-red-200 text-red-500 hover:text-red-600 transition-all transform hover:scale-110 flex items-center justify-center opacity-0 group-hover:opacity-100"
                                                }, h(X, { size: 14 }))         title: task.easy ? "Remove quick tag" : "Mark as quick task"
                                                    }, h('span', { className: "text-sm" }, "ü™Ω")),

                                                    h('button', {
                                                        key: "project",
                                                        onClick: (e) => {
                                                            e.stopPropagation();
                                                            toggleProject(task.id);
                                                        },
                                                        className: `flex-shrink-0 w-8 h-8 rounded-full transition-all transform hover:scale-110 flex items-center justify-center ${
                                                            task.project
                                                                ? "bg-gradient-to-r from-indigo-400 to-violet-400 text-white shadow-lg"
                                                                : "bg-gray-100 hover:bg-indigo-100 text-gray-400 hover:text-indigo-500"
                                                        }`,
                                                        title: task.project ? "Remove project tag" : "Mark as long-term project"
                                                    }, h('span', { className: "text-sm" }, "üêå"))
                                                ],

                                                // Add subtask button
                                                h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        const newExpanded = new Set(expandedTasks);
                                                        newExpanded.add(task.id);
                                                        setExpandedTasks(newExpanded);
                                                    },
                                                    className: "flex-shrink-0 w-7 h-7 rounded-full bg-purple-100 hover:bg-purple-200 text-purple-500 hover:text-purple-600 transition-all transform hover:scale-110 flex items-center justify-center opacity-0 group-hover:opacity-100",
                                                    title: "Add subtask"
                                                }, h(Plus, { size: 12 })),

                                                h('button', {
                                                    onClick: (e) => {
                                                        e.stopPropagation();
                                                        deleteTask(task.id);
                                                    },
                                                    className: "flex-shrink-0 w-7 h-7 rounded-full bg-red-100 hover:bg-red-200 text-red-500 hover:text-red-600 transition-all transform hover:scale-110 flex items-center justify-center opacity-0 group-hover:opacity-100"
                                                }, h(X, { size: 14 }))
                                            )
                                        ),

                                        // Subtasks section
                                        expandedTasks.has(task.id) && h('div', { className: "mt-0 ml-16 mr-4 mb-4 space-y-2 bg-gradient-to-r from-purple-50 to-pink-50 p-4 rounded-xl border border-purple-200" },
                                            // Add new subtask
                                            h('div', { className: "flex gap-2 items-center" },
                                                h('span', { className: "text-sm" }, "üå±"),
                                                h('input', {
                                                    type: "text",
                                                    value: newSubtask[task.id] || "",
                                                    onChange: (e) =>
                                                        setNewSubtask({
                                                            ...newSubtask,
                                                            [task.id]: e.target.value,
                                                        }),
                                                    onKeyPress: (e) => {
                                                        if (e.key === "Enter") {
                                                            addSubtask(task.id);
                                                        }
                                                    },
                                                    placeholder: "Add a subtask...",
                                                    className: "flex-1 px-3 py-2 bg-white/70 border border-purple-200 rounded-full focus:outline-none focus:ring-2 focus:ring-purple-300 focus:border-purple-400 transition-all text-sm text-gray-700"
                                                }),
                                                h('button', {
                                                    onClick: () => addSubtask(task.id),
                                                    className: "px-3 py-2 bg-gradient-to-r from-purple-300 to-pink-300 text-white rounded-full hover:from-purple-400 hover:to-pink-400 transition-all transform hover:scale-105 shadow-sm"
                                                }, h(Plus, { size: 14 }))
                                            ),

                                            // Bulk subtask toggle
                                            h('div', { className: "flex justify-center" },
                                                h('button', {
                                                    onClick: () =>
                                                        setShowBulkSubtask({
                                                            ...showBulkSubtask,
                                                            [task.id]: !showBulkSubtask[task.id],
                                                        }),
                                                    className: "text-xs text-purple-600 hover:text-purple-800 transition-colors flex items-center gap-1"
                                                }, showBulkSubtask[task.id] ? "‚úï Close bulk add" : "ü™Ñ Add multiple subtasks")
                                            ),

                                            // Bulk subtask area
                                            showBulkSubtask[task.id] && h('div', { className: "space-y-2" },
                                                h('textarea', {
                                                    value: bulkSubtasks[task.id] || "",
                                                    onChange: (e) =>
                                                        setBulkSubtasks({
                                                            ...bulkSubtasks,
                                                            [task.id]: e.target.value,
                                                        }),
                                                    placeholder: "Add multiple subtasks, one per line:\n\nSubtask 1\nSubtask 2\nSubtask 3",
                                                    rows: 4,
                                                    className: "w-full px-3 py-2 bg-white/70 border border-purple-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-300 focus:border-purple-400 transition-all text-sm text-gray-700 resize-none"
                                                }),
                                                h('div', { className: "flex gap-2 justify-end" },
                                                    h('button', {
                                                        onClick: () => {
                                                            setBulkSubtasks({
                                                                ...bulkSubtasks,
                                                                [task.id]: "",
                                                            });
                                                            setShowBulkSubtask({
                                                                ...showBulkSubtask,
                                                                [task.id]: false,
                                                            });
                                                        },
                                                        className: "px-3 py-1 bg-gray-200 text-gray-700 rounded-full hover:bg-gray-300 transition-colors text-sm"
                                                    }, "Cancel"),
                                                    h('button', {
                                                        onClick: () => addBulkSubtasks(task.id),
                                                        className: "px-4 py-1 bg-gradient-to-r from-purple-300 to-pink-300 text-white rounded-full hover:from-purple-400 hover:to-pink-400 transition-all transform hover:scale-105 shadow-sm flex items-center gap-1 text-sm"
                                                    }, h('span', null, "ü™Ñ"), "Add All")
                                                )
                                            ),

                                            // Existing subtasks
                                            task.subtasks.map((subtask) =>
                                                h('div', { key: subtask.id, className: "flex items-center gap-3 py-2" },
                                                    h('button', {
                                                        onClick: () => toggleSubtask(task.id, subtask.id),
                                                        className: `flex-shrink-0 w-6 h-6 rounded-full flex items-center justify-center transition-all transform hover:scale-110 ${
                                                            subtask.completed
                                                                ? "bg-gradient-to-r from-green-300 to-emerald-300 shadow-sm"
                                                                : "bg-gradient-to-r from-purple-100 to-pink-100 hover:from-purple-200 hover:to-pink-200 border border-purple-200"
                                                        }`
                                                    },
                                                        subtask.completed ?
                                                            h('span', { className: "text-white text-xs" }, "‚úì") :
                                                            h('span', { className: "text-sm" }, "üå∏")
                                                    ),

                                                    h('span', {
                                                        className: `flex-1 text-sm transition-all ${
                                                            subtask.completed
                                                                ? "text-green-600 line-through opacity-75"
                                                                : "text-gray-700"
                                                        }`
                                                    }, subtask.text),

                                                    h('button', {
                                                        onClick: () => deleteSubtask(task.id, subtask.id),
                                                        className: "flex-shrink-0 w-5 h-5 rounded-full bg-red-100 hover:bg-red-200 text-red-400 hover:text-red-500 transition-all transform hover:scale-110 flex items-center justify-center"
                                                    }, h(X, { size: 10 }))
                                                )
                                            )
                                        )
                                    )
                                )
                        ),

                        // Import/Export buttons
                        h('div', { className: "space-y-3" },
                            completedCount > 0 && h('button', {
                                onClick: clearCompleted,
                                className: "w-full py-3 text-sm bg-gradient-to-r from-purple-100 to-pink-100 hover:from-purple-200 hover:to-pink-200 text-purple-700 rounded-full transition-all transform hover:scale-105 flex items-center justify-center gap-2 border-2 border-purple-200"
                            }, h('span', null, "üå∏"), `Clear ${completedCount} completed task${completedCount !== 1 ? "s" : ""}`, h('span', null, "üå∏")),

                            tasks.length > 0 && [
                                h('button', {
                                    key: "export",
                                    onClick: exportTasks,
                                    className: "w-full py-3 text-sm bg-gradient-to-r from-blue-100 to-cyan-100 hover:from-blue-200 hover:to-cyan-200 text-blue-700 rounded-full transition-all transform hover:scale-105 flex items-center justify-center gap-2 border-2 border-blue-200"
                                }, h('span', null, "üñãÔ∏è"), "Copy All Tasks (Backup)", h('span', null, "üñãÔ∏è")),

                                h('button', {
                                    key: "json",
                                    onClick: exportAsJSON,
                                    className: "w-full py-3 text-sm bg-gradient-to-r from-green-100 to-emerald-100 hover:from-green-200 hover:to-emerald-200 text-green-700 rounded-full transition-all transform hover:scale-105 flex items-center justify-center gap-2 border-2 border-green-200"
                                }, h('span', null, "üåº"), "Download as File", h('span', null, "üåº"))
                            ],

                            h('div', { className: "relative" },
                                h('input', {
                                    type: "file",
                                    accept: ".json",
                                    onChange: importFromJSON,
                                    className: "absolute inset-0 w-full h-full opacity-0 cursor-pointer z-10",
                                    id: "importFile"
                                }),
                                h('label', {
                                    htmlFor: "importFile",
                                    className: "w-full py-3 text-sm bg-gradient-to-r from-yellow-100 to-orange-100 hover:from-yellow-200 hover:to-orange-200 text-orange-700 rounded-full transition-all transform hover:scale-105 flex items-center justify-center gap-2 border-2 border-yellow-200 cursor-pointer block"
                                }, h('span', null, "üíå"), "Import from File", h('span', null, "üíå"))
                            )
                        ),

                        // Summary with celebration
                        tasks.length > 0 && h('div', { className: "mt-6 pt-4 border-t-2 border-pink-200 text-center" },
                            activeCount === 0 && tasks.length > 0 ?
                                h('div', { className: "text-lg font-medium bg-gradient-to-r from-pink-500 to-purple-500 bg-clip-text text-transparent" },
                                    "üéâ All tasks completed! You're amazing! üéâ",
                                    h('div', { className: "flex justify-center gap-2 mt-2 text-2xl" },
                                        h('span', { className: "animate-bounce" }, "üêù"),
                                        h('span', { className: "animate-bounce", style: { animationDelay: "0.2s" } }, "üçÑ"),
                                        h('span', { className: "animate-bounce", style: { animationDelay: "0.4s" } }, "‚ú®")
                                    )
                                ) :
                                h('div', { className: "text-gray-600 flex items-center justify-center gap-2" },
                                    h('span', null, "üå±"),
                                    h('span', null, `${activeCount} task${activeCount !== 1 ? "s" : ""} remaining`),
                                    h('span', null, "üå±")
                                )
                        ),

                        // Bottom decorative elements
                        h('div', { className: "absolute bottom-2 left-4 text-pink-300 text-lg" }, "üçÑ"),
                        h('div', { className: "absolute bottom-2 right-4 text-purple-300 text-lg" }, "üêõ")
                    ),

                    // More floating decorations
                    h('div', { className: "absolute bottom-8 left-8 text-green-300 animate-bounce", style: { animationDelay: "1.5s" } }, "ü¶ã"),
                    h('div', { className: "absolute bottom-12 right-12 text-pink-300 animate-bounce", style: { animationDelay: "0.5s" } }, "üêù")
                )
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(React.createElement(TodoList));
    </script>
</body>
</html>
